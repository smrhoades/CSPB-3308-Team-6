{% extends 'base.html' %}

{% block header %}
	<h1>{% block title %}Chat{% endblock %}</h1>
{% endblock %}

{% block content %}
	<div id="messages"></div>
	<input type="text" id="messageInput" placeholder="Type a message...">
	<button onclick="sendMessage()">Send</button>

	<!-- Load Socket.IO Library -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>

	<script type="text/javascript">
		// Establish a WebSocket connection btwn browser and server
		var socket = io();

		// Listen for connection; send message when connected
		socket.on('connect', function() {
			socket.emit('my event', {data: 'I\'m connected!'});
		});
		
		function sendMessage() {
			var input = document.getElementById('messageInput');
			if (input.value.trim() !== '') {
				socket.emit('message', {data: input.value});
				input.value = '';
			}
		}
		
		// Listen for messages from server
		socket.on('message', function(data) {
			var messages = document.getElementById('messages');
			messages.innerHTML += '<div>' + data.data + '</div>';
		});
	</script>
{% endblock %}
